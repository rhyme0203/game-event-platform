<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ëŸ­í‚¤ë¹¤ì“° - í–‰ìš´ì˜ ë£°ë ›</title>
  <link rel="stylesheet" href="../assets/css/common.css">
  <style>
    .roulette-container {
      position: relative;
      width: 400px;
      height: 400px;
      margin: 0 auto;
    }

    .roulette-wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      position: relative;
      transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
      box-shadow: 0 0 0 15px #fff, 0 0 0 18px var(--primary-color), 0 10px 50px rgba(0, 0, 0, 0.3);
    }

    .roulette-section {
      position: absolute;
      width: 50%;
      height: 50%;
      transform-origin: 100% 100%;
      clip-path: polygon(0% 0%, 100% 0%, 100% 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
      color: white;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .roulette-section span {
      position: absolute;
      top: 30%;
      left: 60%;
      transform: rotate(-22.5deg);
    }

    .roulette-pin {
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-top: 35px solid var(--danger-color);
      z-index: 10;
      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.3));
    }

    .roulette-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80px;
      height: 80px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      z-index: 5;
    }

    .spin-count {
      margin-top: 30px;
      font-size: 1.1em;
      color: #666;
      font-weight: 600;
    }

    .spin-count span {
      color: var(--primary-color);
      font-size: 1.3em;
      font-weight: 700;
    }

    @media (max-width: 600px) {
      .roulette-container {
        width: 300px;
        height: 300px;
      }
      .roulette-center {
        width: 60px;
        height: 60px;
        font-size: 28px;
      }
      .roulette-section {
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="game-card">
      <h1>ğŸ¡ í–‰ìš´ì˜ ë£°ë ›</h1>
      <p class="subtitle">ë£°ë ›ì„ ëŒë ¤ ê²½í’ˆì„ ë°›ì•„ê°€ì„¸ìš”!</p>

      <div class="game-area">
        <div class="roulette-container">
          <div class="roulette-pin"></div>
          <div class="roulette-wheel" id="wheel">
            <!-- ë£°ë › ì„¹ì…˜ë“¤ì´ JavaScriptë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
          </div>
          <div class="roulette-center">ğŸ</div>
        </div>
        
        <div class="spin-count">
          ë‚¨ì€ ê¸°íšŒ: <span id="remaining">3</span>íšŒ
        </div>
      </div>

      <button class="start-button" id="spinBtn">ë£°ë › ëŒë¦¬ê¸°</button>

      <div class="info-box">
        <p><strong>ì°¸ì—¬ ë°©ë²•</strong></p>
        <p>ë²„íŠ¼ì„ ëˆŒëŸ¬ ë£°ë ›ì„ ëŒë¦¬ë©´ ìë™ìœ¼ë¡œ ê²½í’ˆì´ ì¶”ì²¨ë©ë‹ˆë‹¤.</p>
        <p>í•˜ë£¨ 3íšŒê¹Œì§€ ì°¸ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
      </div>

      <a href="../index.html" class="back-link">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
  </div>

  <!-- ê²°ê³¼ ëª¨ë‹¬ -->
  <div class="result-modal" id="resultModal">
    <div class="result-content">
      <div class="result-icon">ğŸ‰</div>
      <div class="result-title">ì¶•í•˜í•©ë‹ˆë‹¤!</div>
      <div class="result-prize" id="prizeText"></div>
      <button class="close-button" id="closeBtn">í™•ì¸</button>
    </div>
  </div>

  <script>
    // ê²½í’ˆ ë°ì´í„°
    const prizes = [
      { name: '1ë“±: ìŠ¤íƒ€ë²…ìŠ¤ ê¸°í”„í‹°ì½˜', color: '#ff6b6b', probability: 5 },
      { name: 'ê½', color: '#95a5a6', probability: 25 },
      { name: '2ë“±: 500 í¬ì¸íŠ¸', color: '#4ecdc4', probability: 15 },
      { name: 'ê½', color: '#95a5a6', probability: 25 },
      { name: '3ë“±: 100 í¬ì¸íŠ¸', color: '#f39c12', probability: 20 },
      { name: '4ë“±: ì¿ í° 5%', color: '#9b59b6', probability: 10 }
    ];

    let remaining = 3;
    let isSpinning = false;
    let currentRotation = 0;

    const wheel = document.getElementById('wheel');
    const spinBtn = document.getElementById('spinBtn');
    const resultModal = document.getElementById('resultModal');
    const prizeText = document.getElementById('prizeText');
    const closeBtn = document.getElementById('closeBtn');
    const remainingText = document.getElementById('remaining');

    // ë£°ë › íœ  ìƒì„±
    function createWheel() {
      const sectionAngle = 360 / prizes.length;
      prizes.forEach((prize, index) => {
        const section = document.createElement('div');
        section.className = 'roulette-section';
        section.style.transform = `rotate(${index * sectionAngle}deg)`;
        section.style.backgroundColor = prize.color;
        
        const text = document.createElement('span');
        text.textContent = prize.name;
        section.appendChild(text);
        
        wheel.appendChild(section);
      });
    }

    // í™•ë¥ ì— ë”°ë¥¸ ê²½í’ˆ ì„ íƒ
    function selectPrize() {
      const totalProbability = prizes.reduce((sum, prize) => sum + prize.probability, 0);
      let random = Math.random() * totalProbability;
      
      for (let i = 0; i < prizes.length; i++) {
        random -= prizes[i].probability;
        if (random <= 0) {
          return i;
        }
      }
      return 0;
    }

    // ë£°ë › ëŒë¦¬ê¸°
    function spin() {
      if (isSpinning || remaining <= 0) return;
      
      isSpinning = true;
      spinBtn.disabled = true;
      
      const selectedIndex = selectPrize();
      const sectionAngle = 360 / prizes.length;
      
      // ìµœì†Œ 5ë°”í€´ + ì„ íƒëœ ì„¹ì…˜ìœ¼ë¡œ ì´ë™
      const minRotation = 360 * 5;
      const targetRotation = minRotation + (360 - (selectedIndex * sectionAngle)) - (sectionAngle / 2);
      currentRotation += targetRotation;
      
      wheel.style.transform = `rotate(${currentRotation}deg)`;
      
      setTimeout(() => {
        isSpinning = false;
        remaining--;
        remainingText.textContent = remaining;
        
        if (remaining > 0) {
          spinBtn.disabled = false;
        } else {
          spinBtn.textContent = 'ì°¸ì—¬ ê¸°íšŒ ì†Œì§„';
        }
        
        showResult(prizes[selectedIndex].name);
      }, 4000);
    }

    // ê²°ê³¼ í‘œì‹œ
    function showResult(prize) {
      prizeText.textContent = prize;
      resultModal.classList.add('show');
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal() {
      resultModal.classList.remove('show');
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    spinBtn.addEventListener('click', spin);
    closeBtn.addEventListener('click', closeModal);
    resultModal.addEventListener('click', (e) => {
      if (e.target === resultModal) closeModal();
    });

    // ì´ˆê¸°í™”
    createWheel();
  </script>
</body>
</html>

