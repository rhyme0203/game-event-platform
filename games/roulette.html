<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ°</text></svg>">
  <title>ëŸ­í‚¤ë¹¤ì“° - í–‰ìš´ì˜ ë£°ë ›</title>
  <link rel="stylesheet" href="../assets/css/common.css">
  <link rel="stylesheet" href="../assets/css/ads.css">
  <link rel="stylesheet" href="../assets/css/ad-modal.css">
  <link rel="stylesheet" href="../assets/css/point-system.css">
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8451876651536601" crossorigin="anonymous"></script>
  
  <style>
    body {
      background: white !important;
      margin: 0;
      padding: 0;
    }
    
    .game-container {
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
      text-align: center;
    }
    
    .roulette-wheel {
      width: 300px;
      height: 300px;
      border-radius: 50%;
      border: 8px solid #333;
      position: relative;
      margin: 20px auto;
      background: conic-gradient(
        #ff6b6b 0deg 45deg,
        #4ecdc4 45deg 90deg,
        #45b7d1 90deg 135deg,
        #96ceb4 135deg 180deg,
        #feca57 180deg 225deg,
        #ff9ff3 225deg 270deg,
        #54a0ff 270deg 315deg,
        #5f27cd 315deg 360deg
      );
      transition: transform 3s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .roulette-wheel.spinning {
      animation: spin 3s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(1800deg); }
    }
    
    .roulette-pointer {
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-bottom: 30px solid #333;
      z-index: 10;
    }
    
    .prize-section {
      margin: 20px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 10px;
    }
    
    .prize-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }
    
    .prize-item:last-child {
      border-bottom: none;
    }
    
    .prize-name {
      font-weight: bold;
      color: #333;
    }
    
    .prize-probability {
      color: #666;
      font-size: 14px;
    }
    
    .attempts-info {
      margin: 15px 0;
      font-size: 16px;
      color: #333;
    }
    
    .start-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: block;
      margin: 20px auto;
      text-align: center;
    }
    
    .start-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .start-button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .result-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 1000;
    }
    
    .result-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      max-width: 300px;
      width: 90%;
    }
    
    .result-prize {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin: 20px 0;
    }
    
    .result-actions {
      margin-top: 20px;
    }
    
    .result-actions button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      margin: 0 5px;
    }
    
    .ad-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 1000;
    }
    
    .ad-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      max-width: 300px;
      width: 90%;
    }
    
    .ad-placeholder {
      background: #f0f0f0;
      height: 250px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px dashed #ccc;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>ğŸ° í–‰ìš´ì˜ ë£°ë ›</h1>
    
    <div class="roulette-wheel" id="rouletteWheel">
      <div class="roulette-pointer"></div>
    </div>
    
    <div class="prize-section">
      <h3>ğŸ ê²½í’ˆ ëª©ë¡</h3>
      <div id="prizeList"></div>
    </div>
    
    <div class="attempts-info">
      ë‚¨ì€ ì‹œë„ íšŸìˆ˜: <span id="remainingAttempts">3</span>íšŒ
    </div>
    
    <button class="start-button" id="spinBtn">ë£°ë › ëŒë¦¬ê¸°</button>
  </div>
  
  <!-- ê²°ê³¼ ëª¨ë‹¬ -->
  <div class="result-modal" id="resultModal">
    <div class="result-content">
      <h2>ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
      <div class="result-prize" id="resultPrize"></div>
      <div class="result-actions">
        <button onclick="closeResultModal()">í™•ì¸</button>
        <button onclick="showAdModal()">ê´‘ê³  ë³´ê¸°</button>
      </div>
    </div>
  </div>
  
  <!-- ê´‘ê³  ëª¨ë‹¬ -->
  <div class="ad-modal" id="adModal">
    <div class="ad-content">
      <h3>ê´‘ê³ ë¥¼ ì‹œì²­í•´ì£¼ì„¸ìš”</h3>
      <div class="ad-placeholder" id="adPlaceholder">
        ê´‘ê³  ë¡œë”© ì¤‘...
      </div>
      <button onclick="closeAdModal()">ë‹«ê¸°</button>
    </div>
  </div>
  
  <!-- í¬ì¸íŠ¸ ì‹œìŠ¤í…œ -->
  <script src="../assets/js/point-system.js"></script>
  
  <script>
    console.log('ë£°ë › ê²Œì„ ì‹œì‘!');
    
    // ê²Œì„ ìƒíƒœ
    let isSpinning = false;
    let remaining = 3;
    let selectedPrize = null;
    
    // ê¸°ë³¸ ê²½í’ˆ ë°ì´í„°
    const defaultPrizes = [
      { name: "100í¬ì¸íŠ¸", probability: 30, points: 100 },
      { name: "200í¬ì¸íŠ¸", probability: 25, points: 200 },
      { name: "500í¬ì¸íŠ¸", probability: 20, points: 500 },
      { name: "1000í¬ì¸íŠ¸", probability: 15, points: 1000 },
      { name: "ê½", probability: 10, points: 0 }
    ];
    
    let prizes = [...defaultPrizes];
    
    // DOM ìš”ì†Œë“¤
    const rouletteWheel = document.getElementById('rouletteWheel');
    const spinBtn = document.getElementById('spinBtn');
    const remainingAttempts = document.getElementById('remainingAttempts');
    const prizeList = document.getElementById('prizeList');
    const resultModal = document.getElementById('resultModal');
    const resultPrize = document.getElementById('resultPrize');
    const adModal = document.getElementById('adModal');
    const adPlaceholder = document.getElementById('adPlaceholder');
    
    // í¬ì¸íŠ¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
    let pointSystem = null;
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM ë¡œë“œ ì™„ë£Œ');
      
      // í¬ì¸íŠ¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
      if (window.PointSystem) {
        pointSystem = new window.PointSystem();
        console.log('í¬ì¸íŠ¸ ì‹œìŠ¤í…œ ë¡œë“œë¨');
      }
      
      // ê²½í’ˆ ëª©ë¡ í‘œì‹œ
      displayPrizes();
      
      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      spinBtn.addEventListener('click', spin);
      
      console.log('ë£°ë › ê²Œì„ ì´ˆê¸°í™” ì™„ë£Œ');
    });
    
    // ê²½í’ˆ ëª©ë¡ í‘œì‹œ
    function displayPrizes() {
      prizeList.innerHTML = '';
      prizes.forEach(prize => {
        const prizeItem = document.createElement('div');
        prizeItem.className = 'prize-item';
        prizeItem.innerHTML = `
          <span class="prize-name">${prize.name}</span>
          <span class="prize-probability">${prize.probability}%</span>
        `;
        prizeList.appendChild(prizeItem);
      });
    }
    
    // ë£°ë › ëŒë¦¬ê¸°
    function spin() {
      if (isSpinning || remaining <= 0) return;
      
      console.log('ë£°ë › ëŒë¦¬ê¸° ì‹œì‘');
      isSpinning = true;
      spinBtn.disabled = true;
      spinBtn.textContent = 'ëŒë¦¬ëŠ” ì¤‘...';
      
      // ë£°ë › íšŒì „ ì• ë‹ˆë©”ì´ì…˜
      rouletteWheel.classList.add('spinning');
      
      // 3ì´ˆ í›„ ê²°ê³¼ ê²°ì •
      setTimeout(() => {
        selectPrize();
        rouletteWheel.classList.remove('spinning');
        showResult();
        isSpinning = false;
        spinBtn.disabled = false;
        spinBtn.textContent = 'ë£°ë › ëŒë¦¬ê¸°';
      }, 3000);
    }
    
    // ê²½í’ˆ ì„ íƒ
    function selectPrize() {
      const random = Math.random() * 100;
      let cumulative = 0;
      
      for (let prize of prizes) {
        cumulative += prize.probability;
        if (random <= cumulative) {
          selectedPrize = prize;
          break;
        }
      }
      
      console.log('ì„ íƒëœ ê²½í’ˆ:', selectedPrize);
    }
    
    // ê²°ê³¼ í‘œì‹œ
    function showResult() {
      remaining--;
      remainingAttempts.textContent = remaining;
      
      if (selectedPrize) {
        resultPrize.textContent = selectedPrize.name;
        
        // í¬ì¸íŠ¸ ì§€ê¸‰
        if (selectedPrize.points > 0 && pointSystem) {
          pointSystem.addPoints(selectedPrize.points, `ë£°ë › ê²Œì„: ${selectedPrize.name}`);
          console.log(`${selectedPrize.points}í¬ì¸íŠ¸ ì§€ê¸‰ë¨`);
        }
      }
      
      resultModal.style.display = 'block';
      
      // ì‹œë„ íšŸìˆ˜ í™•ì¸
      if (remaining <= 0) {
        setTimeout(() => {
          spinBtn.textContent = 'ì‹œë„ íšŸìˆ˜ ì´ˆê³¼';
          spinBtn.disabled = true;
        }, 1000);
      }
    }
    
    // ê²°ê³¼ ëª¨ë‹¬ ë‹«ê¸°
    function closeResultModal() {
      resultModal.style.display = 'none';
    }
    
    // ê´‘ê³  ëª¨ë‹¬ í‘œì‹œ
    function showAdModal() {
      resultModal.style.display = 'none';
      adModal.style.display = 'block';
      
      // AdSense ê´‘ê³  ë¡œë“œ
      setTimeout(() => {
        try {
          (adsbygoogle = window.adsbygoogle || []).push({});
          console.log('AdSense ê´‘ê³  ë¡œë“œë¨');
        } catch (error) {
          console.error('AdSense ì˜¤ë¥˜:', error);
        }
      }, 100);
      
      // 3ì´ˆ í›„ ê´‘ê³  ì™„ë£Œ ì²˜ë¦¬
      setTimeout(() => {
        adPlaceholder.textContent = 'ê´‘ê³  ì‹œì²­ ì™„ë£Œ!';
        adPlaceholder.style.background = '#d4edda';
        adPlaceholder.style.color = '#155724';
      }, 3000);
    }
    
    // ê´‘ê³  ëª¨ë‹¬ ë‹«ê¸°
    function closeAdModal() {
      adModal.style.display = 'none';
      
      // ê´‘ê³  ì‹œì²­ í›„ ë³´ë„ˆìŠ¤ í¬ì¸íŠ¸ ì§€ê¸‰
      if (pointSystem) {
        pointSystem.addPoints(50, 'ê´‘ê³  ì‹œì²­ ë³´ë„ˆìŠ¤');
        console.log('ê´‘ê³  ì‹œì²­ ë³´ë„ˆìŠ¤ 50í¬ì¸íŠ¸ ì§€ê¸‰ë¨');
      }
    }
    
    // ì „ì—­ í•¨ìˆ˜ë¡œ ë“±ë¡
    window.closeResultModal = closeResultModal;
    window.showAdModal = showAdModal;
    window.closeAdModal = closeAdModal;
  </script>
</body>
</html>