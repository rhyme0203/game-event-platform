<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ëŸ­í‚¤ë¹¤ì“° - ìº¡ìŠë½‘ê¸°</title>
  <link rel="stylesheet" href="../assets/css/common.css">
  <link rel="stylesheet" href="../assets/css/ad-modal.css">
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8451876651536601"
       crossorigin="anonymous"></script>
  <style>
    .capsule-machine {
      position: relative;
      max-width: 450px;
      margin: 0 auto;
    }

    .capsule-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin: 40px 0;
    }

    .capsule {
      aspect-ratio: 1;
      background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3em;
      animation: float 3s ease-in-out infinite;
    }

    .capsule:nth-child(1) { animation-delay: 0s; background: linear-gradient(145deg, #ff6b6b, #ee5a6f); }
    .capsule:nth-child(2) { animation-delay: 0.5s; background: linear-gradient(145deg, #4ecdc4, #44a9a3); }
    .capsule:nth-child(3) { animation-delay: 1s; background: linear-gradient(145deg, #f39c12, #e67e22); }
    .capsule:nth-child(4) { animation-delay: 1.5s; background: linear-gradient(145deg, #9b59b6, #8e44ad); }
    .capsule:nth-child(5) { animation-delay: 2s; background: linear-gradient(145deg, #3498db, #2980b9); }
    .capsule:nth-child(6) { animation-delay: 2.5s; background: linear-gradient(145deg, #1abc9c, #16a085); }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .capsule:hover:not(.opened) {
      transform: translateY(-15px) scale(1.1);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
    }

    .capsule:active:not(.opened) {
      transform: translateY(-5px) scale(0.95);
    }

    .capsule.opened {
      opacity: 0.3;
      cursor: not-allowed;
      animation: none;
    }

    .capsule.opening {
      animation: shake 0.5s ease;
    }

    @keyframes shake {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-15deg); }
      75% { transform: rotate(15deg); }
    }

    .instruction {
      text-align: center;
      font-size: 1.2em;
      color: #666;
      margin: 20px 0;
      font-weight: 600;
    }

    .capsule-number {
      position: absolute;
      bottom: -5px;
      right: -5px;
      width: 30px;
      height: 30px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.4em;
      font-weight: 700;
      color: var(--primary-color);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    @media (max-width: 600px) {
      .capsule-container {
        gap: 15px;
      }
      .capsule {
        font-size: 2em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="game-card">
      <h1>ğŸ”® ìº¡ìŠë½‘ê¸°</h1>
      <p class="subtitle">ì›í•˜ëŠ” ìº¡ìŠì„ ê³¨ë¼ë³´ì„¸ìš”!</p>

      <div class="game-area">
        <div class="instruction">
          âœ¨ ìº¡ìŠì„ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš” âœ¨
        </div>

        <div class="capsule-container" id="capsuleContainer">
          <div class="capsule" data-index="0">
            ğŸ
            <div class="capsule-number">1</div>
          </div>
          <div class="capsule" data-index="1">
            ğŸ
            <div class="capsule-number">2</div>
          </div>
          <div class="capsule" data-index="2">
            ğŸ
            <div class="capsule-number">3</div>
          </div>
          <div class="capsule" data-index="3">
            ğŸ
            <div class="capsule-number">4</div>
          </div>
          <div class="capsule" data-index="4">
            ğŸ
            <div class="capsule-number">5</div>
          </div>
          <div class="capsule" data-index="5">
            ğŸ
            <div class="capsule-number">6</div>
          </div>
        </div>
      </div>

      <div class="info-box">
        <p><strong>ì°¸ì—¬ ë°©ë²•</strong></p>
        <p>6ê°œì˜ ìº¡ìŠ ì¤‘ ë§ˆìŒì— ë“œëŠ” í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
        <p>ê° ìº¡ìŠë§ˆë‹¤ ë‹¤ë¥¸ ê²½í’ˆì´ ë“¤ì–´ìˆìŠµë‹ˆë‹¤!</p>
        <p style="margin-top: 10px; color: var(--primary-color);"><strong>ğŸ’¡ TIP:</strong> ì²« ë²ˆì§¸ ì§ê°ì„ ë¯¿ì–´ë³´ì„¸ìš”!</p>
      </div>

      <a href="../index.html" class="back-link">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
  </div>

  <!-- ê²°ê³¼ ëª¨ë‹¬ -->
  <div class="result-modal" id="resultModal">
    <div class="result-content">
      <div class="result-icon">ğŸŠ</div>
      <div class="result-title">ìº¡ìŠì„ ì—´ì—ˆìŠµë‹ˆë‹¤!</div>
      <div class="result-prize" id="prizeText"></div>
      <button class="close-button" id="closeBtn">í™•ì¸</button>
    </div>
  </div>

  <!-- ê´‘ê³  ëª¨ë‹¬ -->
  <div class="ad-modal" id="adModal">
    <div class="ad-modal-content">
      <button class="ad-modal-close" onclick="closeAdModalAndSpin()">&times;</button>
      
      <div class="ad-modal-header">
        <div class="ad-modal-title">ğŸ¯ íŠ¹ë³„ ì´ë²¤íŠ¸!</div>
        <div class="ad-modal-subtitle">ëŸ­í‚¤ë¹¤ì“° í”„ë¦¬ë¯¸ì—„ ì„œë¹„ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”</div>
      </div>
      
      <div class="ad-modal-body">
        <div class="ad-modal-ad">
          <!-- Google AdSense ê´‘ê³  -->
          <ins class="adsbygoogle"
               style="display:block;width:300px;height:250px;"
               data-ad-client="ca-pub-8451876651536601"
               data-ad-slot="5939741579"></ins>
          <div class="ad-modal-ad-placeholder" style="display:none;">
            ê´‘ê³  ë¡œë”© ì¤‘...
          </div>
        </div>
        
        <div class="ad-modal-countdown" id="countdown" style="display:none;">
          <span id="countdownText">5</span>ì´ˆ í›„ ê²Œì„ ì‹œì‘
        </div>
      </div>
      
      <div class="ad-modal-footer">
        <button class="ad-modal-btn ad-modal-btn-primary" onclick="startGame()" id="startGameBtn">
          ê²Œì„ ì‹œì‘í•˜ê¸°
        </button>
        <button class="ad-modal-btn ad-modal-btn-secondary" onclick="skipAd()">
          ê´‘ê³  ê±´ë„ˆë›°ê¸°
        </button>
      </div>
    </div>
  </div>

  <script>
    const prizes = [
      { name: '1ë“±: 10,000ì› ìƒí’ˆê¶Œ', emoji: 'ğŸ’' },
      { name: '2ë“±: 5,000ì› ìƒí’ˆê¶Œ', emoji: 'ğŸ' },
      { name: '3ë“±: 3,000 í¬ì¸íŠ¸', emoji: 'â­' },
      { name: '4ë“±: 1,000 í¬ì¸íŠ¸', emoji: 'ğŸ«' },
      { name: '5ë“±: 500 í¬ì¸íŠ¸', emoji: 'ğŸª' },
      { name: 'ê½: ë‹¤ìŒ ê¸°íšŒì—!', emoji: 'ğŸ˜¢' }
    ];

    let hasSelected = false;
    let selectedCapsule = null;
    const capsules = document.querySelectorAll('.capsule');
    const resultModal = document.getElementById('resultModal');
    const prizeText = document.getElementById('prizeText');
    const closeBtn = document.getElementById('closeBtn');

    // ìº¡ìŠ í´ë¦­ ì´ë²¤íŠ¸
    capsules.forEach(capsule => {
      capsule.addEventListener('click', function() {
        if (hasSelected || this.classList.contains('opened')) return;
        
        // ê´‘ê³  ëª¨ë‹¬ í‘œì‹œ
        showAdModal();
        
        // ì„ íƒí•œ ìº¡ìŠ ì €ì¥
        selectedCapsule = this;
        
        setTimeout(() => {
          // ìº¡ìŠ ì—´ê¸° ì• ë‹ˆë©”ì´ì…˜
          this.textContent = prize.emoji;
          this.classList.remove('opening');
          this.classList.add('opened');
          
          // ë‚˜ë¨¸ì§€ ìº¡ìŠë“¤ë„ ì—´ê¸°
          capsules.forEach(c => {
            if (c !== this) {
              c.classList.add('opened');
              const randomPrize = prizes[Math.floor(Math.random() * prizes.length)];
              c.textContent = randomPrize.emoji;
            }
          });
          
          setTimeout(() => {
            showResult(prize.name);
          }, 500);
        }, 500);
      });
    });

    // ê²°ê³¼ í‘œì‹œ
    function showResult(prize) {
      prizeText.textContent = prize;
      resultModal.classList.add('show');
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal() {
      resultModal.classList.remove('show');
      // ê²Œì„ ë¦¬ì…‹
      setTimeout(() => {
        hasSelected = false;
        capsules.forEach((capsule, index) => {
          capsule.classList.remove('opened', 'opening');
          capsule.textContent = 'ğŸ';
          const number = capsule.querySelector('.capsule-number');
          if (!number) {
            const numDiv = document.createElement('div');
            numDiv.className = 'capsule-number';
            numDiv.textContent = index + 1;
            capsule.appendChild(numDiv);
          }
        });
      }, 300);
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    closeBtn.addEventListener('click', closeModal);
    resultModal.addEventListener('click', (e) => {
      if (e.target === resultModal) closeModal();
    });
  </script>
</body>
</html>

