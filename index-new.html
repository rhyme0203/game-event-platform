<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>럭키빤쓰 - 행운을 잡아라!</title>
  <link rel="stylesheet" href="assets/css/common.css">
  <link rel="stylesheet" href="assets/css/ads.css">
  <link rel="stylesheet" href="assets/css/point-system.css">
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8451876651536601"
       crossorigin="anonymous"></script>
  
  <!-- AdSense 코드 스니펫 -->
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-8451876651536601",
      enable_page_level_ads: true
    });
  </script>
  
  <style>
    /* 메인 컨테이너 - 모바일 웹 최적화 */
    .main-container {
      max-width: 414px;
      margin: 0 auto;
      background: #f8f9fa;
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    /* 헤더 섹션 */
    .main-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .main-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%, 100% { transform: translateX(-100%) translateY(-100%); }
      50% { transform: translateX(100%) translateY(100%); }
    }

    .main-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 8px;
      position: relative;
      z-index: 1;
    }

    .main-subtitle {
      font-size: 14px;
      opacity: 0.9;
      position: relative;
      z-index: 1;
    }

    /* 포인트 표시 섹션 */
    .points-display {
      background: white;
      margin: -20px 20px 20px 20px;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      position: relative;
      z-index: 10;
    }

    .points-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .points-label {
      font-size: 14px;
      color: #666;
      font-weight: 500;
    }

    .points-amount {
      font-size: 20px;
      font-weight: bold;
      color: #28a745;
    }

    .points-actions {
      display: flex;
      gap: 8px;
    }

    .points-btn {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 6px;
      padding: 6px 12px;
      font-size: 12px;
      color: #666;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .points-btn:hover {
      background: #e9ecef;
    }

    /* 게임 그리드 - 모바일 최적화 */
    .games-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      padding: 20px;
    }

    .game-item {
      background: white;
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
      text-decoration: none;
      color: inherit;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border: 1px solid #e9ecef;
      position: relative;
      overflow: hidden;
    }

    .game-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .game-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2);
    }

    .game-icon {
      font-size: 32px;
      margin-bottom: 12px;
      display: block;
    }

    .game-name {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 6px;
      color: #333;
    }

    .game-desc {
      font-size: 11px;
      color: #666;
      line-height: 1.4;
    }

    /* 출석체크 섹션 */
    .attendance-section {
      background: white;
      margin: 0 20px 20px 20px;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .attendance-title {
      font-size: 16px;
      font-weight: 600;
      color: #333;
      margin-bottom: 12px;
    }

    .attendance-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .attendance-stats {
      font-size: 12px;
      color: #666;
    }

    .attendance-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      justify-content: center;
    }

    .attendance-btn:hover {
      transform: scale(1.05);
    }

    .attendance-btn:disabled {
      background: #6c757d;
      cursor: not-allowed;
      transform: none;
    }

    /* 정보 박스 */
    .info-box {
      background: white;
      margin: 0 20px 20px 20px;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .info-title {
      font-size: 16px;
      font-weight: 600;
      color: #333;
      margin-bottom: 12px;
    }

    .info-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .info-list li {
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
      padding-left: 16px;
      position: relative;
    }

    .info-list li::before {
      content: '✅';
      position: absolute;
      left: 0;
    }

    /* 반응형 디자인 */
    @media (max-width: 375px) {
      .games-grid {
        grid-template-columns: 1fr;
        gap: 8px;
        padding: 16px;
      }
      
      .game-item {
        padding: 16px;
      }
      
      .game-icon {
        font-size: 28px;
      }
    }

    /* 다크 모드 */
    @media (prefers-color-scheme: dark) {
      .main-container {
        background: #1a1a1a;
      }
      
      .points-display,
      .attendance-section,
      .info-box,
      .game-item {
        background: #2d2d2d;
        border-color: #404040;
      }
      
      .game-name,
      .attendance-title,
      .info-title {
        color: white;
      }
      
      .game-desc,
      .attendance-stats,
      .info-list li {
        color: #ccc;
      }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <!-- 헤더 섹션 -->
    <div class="main-header">
      <h1 class="main-title">🎰 럭키빤쓰</h1>
      <p class="main-subtitle">행운을 잡아라! 다양한 게임으로 상품을 획득하세요</p>
    </div>

    <!-- 포인트 표시 섹션 -->
    <div class="points-display">
      <div class="points-info">
        <span class="points-label">내 포인트</span>
        <span class="points-amount" id="currentPoints">0P</span>
      </div>
      <div class="points-actions">
        <button class="points-btn" onclick="showPointHistory()">히스토리</button>
        <button class="points-btn" onclick="goToOfferwall()">적립하기</button>
      </div>
    </div>

    <!-- 출석체크 섹션 -->
    <div class="attendance-section">
      <h3 class="attendance-title">📅 출석체크</h3>
      <div class="attendance-info">
        <div class="attendance-stats">
          <div>연속 출석: <span id="consecutiveDays">0</span>일</div>
          <div>총 출석: <span id="totalDays">0</span>일</div>
        </div>
      </div>
      <button class="attendance-btn" id="attendanceBtn" onclick="checkAttendance()">
        <span class="btn-text">출석체크</span>
        <span class="btn-icon">✅</span>
      </button>
    </div>

    <!-- 게임 그리드 -->
    <div class="games-grid">
      <a href="games/roulette.html" class="game-item">
        <span class="game-icon">🎡</span>
        <div class="game-name">룰렛</div>
        <div class="game-desc">돌아가는 룰렛으로 행운의 상품을 받아보세요</div>
      </a>

      <a href="games/slot.html" class="game-item">
        <span class="game-icon">🎰</span>
        <div class="game-name">슬롯머신</div>
        <div class="game-desc">3개의 릴을 돌려 같은 그림을 맞춰보세요</div>
      </a>

      <a href="games/capsule.html" class="game-item">
        <span class="game-icon">🔮</span>
        <div class="game-name">캡슐뽑기</div>
        <div class="game-desc">알록달록한 캡슐 중 하나를 선택해보세요</div>
      </a>

      <a href="games/scratch.html" class="game-item">
        <span class="game-icon">🎫</span>
        <div class="game-name">스크래치</div>
        <div class="game-desc">긁어서 숨겨진 상품을 확인하세요</div>
      </a>

      <a href="offerwall.html" class="game-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <span class="game-icon">💰</span>
        <div class="game-name">포인트 적립</div>
        <div class="game-desc">미션을 완료하고 포인트를 모아보세요</div>
      </a>
    </div>

    <!-- 정보 박스 -->
    <div class="info-box">
      <h3 class="info-title">💡 이런 기능들을 제공합니다</h3>
      <ul class="info-list">
        <li>다양한 게임 타입 지원 (룰렛, 슬롯, 캡슐, 스크래치 등)</li>
        <li>실시간 포인트 적립 시스템</li>
        <li>출석체크 보너스</li>
        <li>모바일 웹 최적화</li>
        <li>AdSense 광고 지원</li>
      </ul>
    </div>
  </div>

  <!-- 포인트 시스템 -->
  <script src="assets/js/point-system.js"></script>
  <script src="assets/js/admin-integration.js"></script>
  <script src="assets/js/github-db.js"></script>
  
  <script>
    // 출석체크 데이터
    let attendanceData = {
      lastCheckDate: null,
      totalDays: 0,
      consecutiveDays: 0
    };

    // 포인트 업데이트
    function updatePoints() {
      const currentPoints = document.getElementById('currentPoints');
      if (currentPoints && window.pointSystem) {
        currentPoints.textContent = window.pointSystem.getPoints().toLocaleString() + 'P';
      }
    }

    // 포인트 히스토리 표시
    function showPointHistory() {
      if (window.pointSystem) {
        window.pointSystem.showHistory();
      }
    }

    // 오퍼월로 이동
    function goToOfferwall() {
      window.location.href = 'offerwall.html';
    }

    // 출석체크 함수
    function checkAttendance() {
      const today = new Date();
      const todayStr = today.toDateString();
      
      // 이미 오늘 출석체크 했는지 확인
      if (attendanceData.lastCheckDate === todayStr) {
        alert('이미 오늘 출석체크를 완료했습니다!');
        return;
      }

      // 출석체크 데이터 업데이트
      attendanceData.lastCheckDate = todayStr;
      attendanceData.totalDays++;
      
      // 포인트 지급
      if (window.pointSystem) {
        window.pointSystem.addPoints(50, '출석체크');
      }
      
      // 연속 출석일수 계산
      const yesterday = new Date(today);
      yesterday.setDate(yesterday.getDate() - 1);
      const yesterdayStr = yesterday.toDateString();
      
      if (attendanceData.lastCheckDate === yesterdayStr) {
        attendanceData.consecutiveDays++;
      } else {
        attendanceData.consecutiveDays = 1;
      }
      
      // 연속 출석 보너스
      if (attendanceData.consecutiveDays >= 7) {
        if (window.pointSystem) {
          window.pointSystem.addPoints(100, '7일 연속 출석 보너스');
        }
        alert('7일 연속 출석 보너스 100P가 지급되었습니다!');
      } else if (attendanceData.consecutiveDays >= 3) {
        if (window.pointSystem) {
          window.pointSystem.addPoints(30, '3일 연속 출석 보너스');
        }
        alert('3일 연속 출석 보너스 30P가 지급되었습니다!');
      }
      
      // 데이터 저장
      localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
      
      // UI 업데이트
      updateAttendanceUI();
      updatePoints();
      
      alert(`출석체크 완료! +50P\n연속 출석: ${attendanceData.consecutiveDays}일\n총 출석: ${attendanceData.totalDays}일`);
    }

    // 출석체크 UI 업데이트
    function updateAttendanceUI() {
      document.getElementById('consecutiveDays').textContent = attendanceData.consecutiveDays;
      document.getElementById('totalDays').textContent = attendanceData.totalDays;
      
      const btn = document.getElementById('attendanceBtn');
      if (attendanceData.lastCheckDate === new Date().toDateString()) {
        btn.disabled = true;
        btn.innerHTML = '<span class="btn-text">출석완료</span><span class="btn-icon">✅</span>';
      }
    }

    // 페이지 로드 시 초기화
    document.addEventListener('DOMContentLoaded', function() {
      // 출석체크 데이터 로드
      const savedData = localStorage.getItem('attendanceData');
      if (savedData) {
        attendanceData = JSON.parse(savedData);
      }
      
      updateAttendanceUI();
      updatePoints();
      
      // 포인트 시스템이 로드될 때까지 대기
      const checkPointSystem = setInterval(() => {
        if (window.pointSystem) {
          updatePoints();
          clearInterval(checkPointSystem);
        }
      }, 100);
    });
  </script>
</body>
</html>
